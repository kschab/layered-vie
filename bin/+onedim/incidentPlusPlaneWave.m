function [V] = incidentPlusPlaneWave(mesh,k0z)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% incidentPlusPlaneWave 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% creates an excitation vector corresponding to a plane wave going in the
% +z direction with longitudinal wavenumber k0z
%
% inputs
%   mesh        [struct]        generated by onedim.generateMesh
%   k0z         [function]      longitudinal wavenumber
%
% outputs
%   V           [N x 1 double]  incident field vector
%
% example: 
%
% kurt schab -- kschab@scu.edu
% scu 
% 2021

N = mesh.N;
dz = mesh.dz;
z = mesh.z;

V = zeros(N,1);
for n = 1:N
    V(n) = dz*onedim.sinc(k0z*dz/(2*pi))*exp(-1j*k0z*z(n));
end

end

