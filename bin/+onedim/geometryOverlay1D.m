function [] = geometryOverlay1D(mesh)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% geometryOverlay1D
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% overlays real and imaginary parts of a mesh's relative permittivity
% profile
%
% inputs
%   mesh        [struct]        generated by onedim.generateMesh
%
% kurt schab -- kschab@scu.edu
% scu 
% 2021

offset = 1.5;
height = 0.1;
ernorm = 5;
dz = mesh.dz;
z = mesh.z;
for n = 1:mesh.N
    patch([-0.5,0.5,0.5,-0.5]*dz+z(n),[0, 0, 1, 1]*height+offset,1,'linestyle','none','facecolor','b','facealpha',min([real(mesh.epr(n)-1)/ernorm,1]))
    patch([-0.5,0.5,0.5,-0.5]*dz+z(n),[1, 1, 2, 2]*height+offset,1,'linestyle','none','facecolor','r','facealpha',min([-imag(mesh.epr(n))/ernorm,1]))
end
end

