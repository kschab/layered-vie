%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% GenerateZp 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Creates Material impedance matrix 
% inputs
%   mesh           [struct]     generated by onedim.generateMesh(contains epr)
% outputs
%   Zp             [N x N double]  Material impedance matrix
%
% example: 
%
% Roopan -- rroopan@scu.edu
% Logan Barnes-- lbarnes@scu.edu
% Sean Shao -- sshao@scu.edu
% scu 
% 2021

function [Zp]= GenerateZp(mesh,k)

rho = onedim.er2rho(k,mesh.epr);
Zp=zeros(mesh.N,mesh.N);
for m=1:mesh.N
    for n=1:mesh.N
        if m==n
            Zp(m,n)=mesh.dz*rho(m);
        end
    end
end
end
%pcolor(Zp)